
@{
    Layout = null;

    ViewBag.Title = "Report Trending";
}

<script>
   // window.print();
</script>
<style>
    @@media print {
        .pagebreak {
            clear: both;
            page-break-after: always;
        }
    }
</style>


<script src="@Url.Content("~/assets/js/chart.js")" type="text/javascript"></script>
<body style="font-family:Arial">

    <img src="@Url.Content("~/assets/images/MElogo.png")" width="200" />


    <div class="page-content-wrapper ">

        <div class="container">

            <h1>Report on @ViewBag.ReportName</h1>
            <h3>From @ViewBag.DateFrom to @ViewBag.DateTo</h3>
            <br style="clear:both" />
            <a style="border:0px;float:left;padding:5px 10px;cursor:pointer;" onclick="window.print()">Print</a>
            <br style="clear:both" />
            <br />
            <div style="float:left">
                <div class="col-md-4">
                    <div class="panel panel-primary">
                        <div class="panel-body">
                            <div class="col-md-4">


                                <div class="ibox float-e-margins" style="width:600px;">
                                    <canvas id="myChart1" width="200" height="200"></canvas>


                                    <script>


                                                var ctx = document.getElementById('myChart1');

                                                    var myChart = new Chart(ctx, {
                                                    type: '@ViewBag.graphtype',
                                                    data: {
                                                        labels: [@Html.Raw(ViewBag.EventType)],
                                                        datasets: [{
                                                            label: '@ViewBag.ReportName',
                                                            data: [@Html.Raw(ViewBag.EventCount)],
                                                            backgroundColor: [
                                                                'rgba(255, 99, 132, 0.2)',
                                                                'rgba(54, 162, 235, 0.2)',
                                                                'rgba(255, 206, 86, 0.2)',
                                                                'rgba(75, 192, 192, 0.2)',
                                                                'rgba(153, 102, 255, 0.2)',
                                                                'rgba(239, 29, 236, 0.2)',
                                                                'rgba(33, 8, 236, 0.2)',
                                                                'rgba(33, 223, 12, 0.2)',
                                                                'rgba(252, 230, 60, 0.2)',
                                                                'rgba(252, 69, 40, 0.2)',
                                                                'rgba(222, 124, 255, 0.2)',
                                                                'rgba(123, 159, 64, 0.2)',
                                                                'rgba(255, 99, 132, 0.2)',
                                                                'rgba(54, 162, 235, 0.2)',
                                                                'rgba(255, 206, 86, 0.2)',
                                                                'rgba(75, 192, 192, 0.2)',
                                                                'rgba(153, 102, 255, 0.2)',
                                                                'rgba(239, 29, 236, 0.2)',
                                                                'rgba(33, 8, 236, 0.2)',
                                                                'rgba(33, 223, 12, 0.2)',
                                                                'rgba(252, 230, 60, 0.2)',
                                                                'rgba(252, 69, 40, 0.2)',
                                                                'rgba(222, 124, 255, 0.2)'
                                                            ],
                                                            borderColor: [
                                                                'rgba(255, 99, 132, 1)',
                                                                'rgba(54, 162, 235, 1)',
                                                                'rgba(255, 206, 86, 1)',
                                                                'rgba(75, 192, 192, 1)',
                                                                'rgba(153, 102, 255, 1)',
                                                                'rgba(239, 29, 236, 1)',
                                                                'rgba(33, 8, 236, 1)',
                                                                'rgba(33, 223, 12, 1)',
                                                                'rgba(252, 230, 60, 1)',
                                                                'rgba(252, 69, 40, 1)',
                                                                'rgba(222, 124, 255, 1)',
                                                                'rgba(123, 159, 64, 1)',
                                                                'rgba(255, 99, 132, 1)',
                                                                'rgba(54, 162, 235, 1)',
                                                                'rgba(255, 206, 86, 1)',
                                                                'rgba(75, 192, 192, 1)',
                                                                'rgba(153, 102, 255, 1)',
                                                                'rgba(239, 29, 236, 1)',
                                                                'rgba(33, 8, 236, 1)',
                                                                'rgba(33, 223, 12, 1)',
                                                                'rgba(252, 230, 60, 1)',
                                                                'rgba(252, 69, 40, 1)',
                                                                'rgba(222, 124, 255, 1)'
                                                            ],
                                                            borderWidth: 1
                                                        }]
                                                    },
                                                    options: {
                                                        'onClick': function (evt, item) {
                                                           // window.location.href = '../Search/' + @Html.Raw(ViewBag.EventType);

                                                            console.log('legend onClick', evt);
                                                            console.log('legd item', item.data);

                                                            @*$.ajax({
                                                                method: "POST",
                                                                url: "@Url.Content("~/Search")",
                                                                data: {
                                                                    EventTypeID: $('#witnessname').val()
                                                                },
                                                                success: function (data) {

                                                                },
                                                                error: function () {
                                                                    alert("Couldn't  proceed!");
                                                                }
                                                            });*@
                                                        },
                                                        scales: {
                                                            yAxes: [{
                                                                ticks: {
                                                                    beginAtZero: true
                                                                }
                                                            }]
                                                        }
                                                    }
                                                });
                                    </script>
                                </div>

                            </div>


                        </div>
                    </div>
                </div>
            </div>


            <div class="pagebreak"></div>

            <div class="col-md-4" style="width:400px; float:left;margin:30px 0 0 100px;">
                <h2>Total No.  @ViewBag.TotalEvent</h2>
                <div class="panel panel-primary">
                    <div class="panel-body">


                        <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
                        <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
                        <script src="https://cdn.datatables.net/buttons/1.5.6/js/dataTables.buttons.min.js"></script>
                        <script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.flash.min.js"></script>
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
                        <script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.html5.min.js"></script>
                        <script src="https://cdn.datatables.net/buttons/1.5.6/js/buttons.print.min.js"></script>

                        <script>
                            // disabling because it automatically sorts without date order

                            //$(document).ready(function () {
                            //    $('#example').DataTable({
                            //        dom: 'Bfrtip',
                            //        buttons: [
                            //            'excel', 'print'
                            //        ]
                            //    });
                            //});
                        </script>
                        <link href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" rel="stylesheet" />
                        <link href="https://cdn.datatables.net/buttons/1.5.6/css/buttons.dataTables.min.css" rel="stylesheet" />




                        <table id="example" class="table table-bordered" style="font-family:Arial; float:left;border-collapse:collapse" border="1" cellpadding="10" cellspacing="10" >
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Count</th>
                                    <th>View</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var td in ViewBag.Tabledata)
                                {
                                    <tr>
                                        <td>@td.TypeText</td>
                                        <td>@td.Count</td>
                                        <td>
                                            @if (ViewBag.reporttype != 7 && ViewBag.reporttype != 8 && ViewBag.reporttype != 12 && ViewBag.reporttype != 13 && ViewBag.reporttype != 14 && ViewBag.reporttype != 15 && ViewBag.reporttype != 16)
                                            {


                                                <form method="post" action="@Url.Content("~/Incidents/Search")">
                                                    <input type="hidden" name="IncidentDateFrom" class="form-control" value="@td.StartDate" />
                                                    <input type="hidden" name="IncidentDateTo" class="form-control" value="@td.EndDate" />
                                                    <input type="hidden" name="@ViewBag.controlname" class="form-control" value="@td.TypeID" />
                                                    <input type="submit" value="Drill down" style="background:none; border-width:0px; color:blue; text-decoration:underline;cursor:pointer" />

                                                </form>
                                            }
                                            else
                                            {

                                        <form method="post" action="@Url.Content("~/RiskRegisters")">
                                            <input type="hidden" name="RRDateFrom" class="form-control" value="@td.StartDate" />
                                            <input type="hidden" name="RRDateTo" class="form-control" value="@td.EndDate" />
                                            <input type="hidden" name="Adequacy" class="form-control" value="@(ViewBag.controlname == "Adequacy" ? td.TypeID : "-1")" />
                                            <input type="hidden" name="RARiskLevel" class="form-control" value="0" />
                                            <input type="hidden" name="Proactive" class="form-control" value="-1" />
                                            <input type="hidden" name="@ViewBag.controlname" class="form-control" value="@td.TypeID" />
                                            <input type="submit" value="Drill down" style="background:none; border-width:0px; color:blue; text-decoration:underline;cursor:pointer" />

                                        </form>
                                            }
                                        </td>
                                    </tr>
                                }

                            </tbody>

                        </table>
                    </div>
                </div>
            </div>

        </div>
    </div>
</body>


